%%%==============================================================================
%% Copyright 2022-23 by Alceu Frigeri
%%
%% This work may be distributed and/or modified under the conditions of
%%
%% * The [LaTeX Project Public License](http://www.latex-project.org/lppl.txt),
%%   version 1.3c (or later), and/or
%% * The [GNU Affero General Public License](https://www.gnu.org/licenses/agpl-3.0.html),
%%   version 3 (or later)
%%
%% This work has the LPPL maintenance status *maintained*.
%%
%% The Current Maintainer of this work is Alceu Frigeri
%%
%% This is version 1.12 (2023/09/23)
%%
%% The list of files that compose this work can be found in the README.md file at
%% https://ctan.org/pkg/ufrgscca
%%
%%%==============================================================================
%% UFRGS stands for "Federal University of Rio Grande do Sul" in south Brazil
%% EE    stands for "Engineering School"
%% CCA   stands for "Control and Automation Engineering Course" (Portuguese acronym)
%%%==============================================================================
\NeedsTeXFormat{LaTeX2e}[2022/06/01]
%%%%\def\tc@tmp@packname{ufrgscca-forms}
%%%%\def\tc@tmp@altpackname{ufrgsccaforms}
%%%%\def\tc@tmp@packdesc{UFRGS/CCA forms commands}
%%%%\def\tc@tmp@packdate{2023/09/23}
%%%%\def\tc@tmp@packversion{1.12}
%%%%\let\@exp\expandafter
%%%%\@exp\edef\csname\tc@tmp@altpackname version\endcsname{\tc@tmp@packversion}
%%%%\@exp\@exp\@exp\ProvidesPackage\@exp\@exp\@exp{\@exp\tc@tmp@packname\@exp}\@exp[\tc@tmp@packdate\space v\tc@tmp@packversion\space\tc@tmp@packdesc]
%%%%
\RequirePackage{amsfonts}


\ProvidesExplPackage
    {ufrgscca-forms}
    {2023/11/10}
    {1.99}
    {UFRGS/CCA forms commands}
\RequirePackage{starray}

\cs_generate_variant:Nn \tl_gset:Nn {Ne}


\DeclareKeys[forms]{
  internreqform.usage = general,
  internreqform.code = {%
        \MakeForm{internshiprequest}
        },%{\tcforms@internreqform},
  internsupervisorform.usage = general,
  internsupervisorform.code = {%
        \MakeForm{internshipsupervisorform}
        },%{\tcforms@internsupervisorform},
  interntutorform.usage = general,
  interntutorform.code = {%
        \MakeForm{internshitutorform}
        },%{\tcforms@interntutorform},
  reqform-I.usage = general,
  reqform-I.code = {%
        \MakeForm{request-I}
        },%{\tcforms@reqform},
  reqform-II.usage = general,
  reqform-II.code = {%
        \MakeForm{request-II}
        },%{\tcforms@reqform},
  coadvisor-I.usage = general,
  coadvisor-I.code = {%
        \MakeForm{coadvisor-I}
        },%{\tcforms@coadvisorform},
  coadvisor-II.usage = general,
  coadvisor-II.code = {%
        \MakeForm{coadvisor-II}
        },%{\tcforms@coadvisorform},
  boardapproval-I.usage = general,
  boardapproval-I.code = {%
        \MakeForm{boardapproval-I}
        },%{\tcforms@examboardform},
  boardapproval-II.usage = general,
  boardapproval-II.code = {%
        \MakeForm{boardapproval-II}
        },%{\tcforms@examboardform},
  %boardapproval-IIb.usage = general,
  %boardapproval-IIb.code = {\tcforms@examboardformTMP},
  advisorsapproval-I.usage = general,
  advisorsapproval-I.code = {%
        \MakeForm{advisorapproval-I}
        },%{\tcforms@advisorapprovalform},
  advisorsapproval-II.usage = general,
  advisorsapproval-II.code = {%
        \MakeForm{advisorapproval-II}
        },%{\tcforms@advisorapprovalform},
  receipts-I.usage = general,
  receipts-I.code = {%
        \MakeForm{receipts-II}
        },%{\tcforms@receiptforms},
  receipts-II.usage = general,
  receipts-II.code = {%
        \MakeForm{receipts-II}
        },%{\tcforms@receiptforms},
  examinersforms-I.usage = general,
  examinersforms-I.code = {%
        \SetReviewer{2}
        \MakeForm{examinersform-I}
        \SetReviewer{3}
        \MakeForm{examinersform-I}
        },%{\tcforms@examinersForms},
  examinersforms-II.usage = general,
  examinersforms-II.code = {%
        \SetReviewer{1}
        \MakeForm{receipts-II}
        \MakeForm{examinersform-II}
        \MakeForm{correctionsform-II}
        \SetReviewer{2}
        \MakeForm{receipts-II}
        \MakeForm{examinersform-II}
        \MakeForm{correctionsform-II}
        \SetReviewer{3}
        \MakeForm{receipts-II}
        \MakeForm{examinersform-II}
        \MakeForm{correctionsform-II}
        },%\tcforms@examinersForms},
  rectifyapproval-I.usage = general,
  rectifyapproval-I.code = {%
        \MakeForm{rectifyapproval-I}
        },%{\tcforms@rectifyapprovalform},
  rectifyapproval-II.usage = general,
  rectifyapproval-II.code = {%
        \MakeForm{rectifyapproval-II}
        },%{\tcforms@rectifyapprovalform},
}


\NewDocumentCommand{\tcforms}{m}{%
  \SetKeys[forms]{#1}%
}

\NewDocumentCommand{\tcemptyforms}{m}{%
  \tccore@resetfields%
  \title{\rule{\tc@namerule}{.1pt}}%
  \tccore@emptyfields%
  \SetKeys[forms]{#1}%
}


%\RequirePackage{expl3}

%\ExplSyntaxOn


\int_new:N \l__ufrgscca_a_int
\int_new:N \l__ufrgscca_b_int
\NewDocumentCommand{\BlankLines}{m}{
  \int_zero:N \l__ufrgscca_a_int
  \int_set:Nn \l__ufrgscca_b_int {#1}
  \int_do_until:nNnn {\l__ufrgscca_a_int} {=} {\l__ufrgscca_b_int}
    {
      \int_incr:N \l__ufrgscca_a_int
      \hrulefill\\\par%

    }
}

\NewDocumentCommand{\SetForm}{mm+m}{
  \prop_put:Nnn \l__ufrgscca_forms_prop {#1.#2}{#3}
}

\NewDocumentCommand{\MakeForm}{m} {
  \begin{center}
    \noindent
    \parbox[t]{\textwidth}
      {
        \centering
%        \vbox to \tc@formwinvoffset
          {
%            \tccover@covertopinfo
            \UseTerm{cover.topbase}\\
			{\sc \prop_item:Nn \l__ufrgscca_forms_prop {#1.heading}}
          }
      }\\[7mm]
    {\bf \prop_item:Nn \l__ufrgscca_forms_prop {#1.title}}
    \prop_if_in:NnTF \l__ufrgscca_forms_prop {#1.footnote}
      {\footnote[1]{\prop_item:Nn \l__ufrgscca_forms_prop {#1.footnote}}}
      {}\\
  \end{center}
%
  \vfill
   \prop_item:Nn \l__ufrgscca_forms_prop {#1.opening}
  \vfill
  \prop_item:Nn \l__ufrgscca_forms_prop {#1.body}
  \vfill
  \prop_item:Nn \l__ufrgscca_forms_prop {#1.closing}
  \pagebreak
  }


\NewDocumentCommand{\SignatureDate}{m}{
  \begin{flushright} \UseTerm{localdate}%
    ~\vspace*{6mm}\\%
%
    $\overline{\text{\emph{#1}}}$%%
  \end{flushright}%
}

\NewDocumentCommand{\BoardDescSignature}{mm}{
  #1:~ \textbf{\DataFields{#2}{name}}\vspace{-2ex}%
    \begin{flushright}%~ \hfill
    \UseLabel{email}:~ \textbf{\DataFields{#2}{email}}~ 
    \UseLabel{phone}:~ \textbf{\DataFields{#2}{phone}}~
    \UseLabel{agree}:~ \rule{\l__ufrgscca_agree_rule_dim}{.1pt}
    \end{flushright}
}


\input{ufrgscca-forms.tex}
  
%\ExplSyntaxOff

